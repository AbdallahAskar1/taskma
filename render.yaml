services:
  - type: web
    name: mysql
    runtime: image
    image: 
      url: abdallahasker/tmsmysql:latest 
    envVars:
      - key: MYSQL_HOST
        value: mysql
      - key: MYSQL_ROOT_PASSWORD
        value: askarpass
      - key: MYSQL_USER
        value: root
      - key: MYSQL_PASSWORD
        value: askarpass
    healthCheck:
      path: /
      port: 3306

  - type: web
    name: nestjs
    runtime: image
    image: 
      url: abdallahasker/backend-nestjs:latest
    envVars:
      - key: MYSQL_HOST
        value: mysql
      - key: MYSQL_ROOT_PASSWORD
        value: askarpass
      - key: MYSQL_USER
        value: root
      - key: MYSQL_PASSWORD
        value: askarpass
    
  - type: web
    name: frontend
    runtime: image
    image:
      url: abdallahasker/backend-frontend:latest 
    healthCheck:
      path: /
      port: 8080

routes:
  - path: /
    service: frontend  
    checkPath: /
    healthCheckTimeout: 5000

  - path: /api/*
    service: nestjs

